<!DOCTYPE html>
<html>
    <head>
        <title>DirecTEL</title>

        <script type="text/javascript" charset="utf-8" src="phonegap-1.2.0.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/index.js"></script>
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <script type="text/javascript" charset="utf-8">
            var cities = false;
            var cats = false;
            // A button will call this function
            function changeCity() {
                localStorage.removeItem("userCity");
                $('#ciudades').animate({'right': '0%'});
                $('#categorias').animate({'right': '-100%'});
                $('#topbar').animate({'top': -50});
                loadCity();
            }
            function setCity(city,cityname) {
                localStorage.userCity = city;
                localStorage.userCityName = cityname;
                $('#ciudades').animate({'right': '100%'});
                $('#categorias').animate({'right': '0%'});
                $('#topbar').animate({'top': 0});
                
                loadCat();
            }
            function loadCity() {
                
                if (!cities) {
                    $.post('http://directel.mx/acciones/serviceCiudades', function(e) {
                        cities=true;
                        var obj = jQuery.parseJSON(e);
                        for (var i in obj) {
                            $('#ciudadCanvas').append('<div class="cityItem" data-city="' + obj[i].id + '">' + obj[i].nombre + '<div class="ballnext"></div></div>');
                        }
                        $('.cityItem').on('click', function() {
                            setCity($(this).attr('data-city'),$(this).text());
                        });
                    });
                }
            }
            function loadCat() {
                $('#city').html(localStorage.userCityName);
                
                if (!cats) {
                    $.post('http://directel.mx/acciones/serviceCategorias', function(e) {
                        cats=true;
                        var obj = jQuery.parseJSON(e);
                        for (var i in obj) {
                            $('#categoriasCanvas').append('<div class="catItem" data-city="' + obj[i].id + '"><img src="img/logo_' + obj[i].url + '.png">' + obj[i].nombre + '<div>' + obj[i].secciones + '</div><div class="ballnext"></div></div>');
                        }
                        $('.catItem').on('click', function() {
                            getcat()
                        });
                    });
                }
            }
            $(function() {
                app.initialize();
                if (!localStorage.userCity) {
                    $('#ciudades').animate({'right': '0%'});
                    loadCity();
                } else {
                    $('#topbar').animate({'top': 0});
                    $('#ciudades').css({'right': '100%'});
                    $('#categorias').animate({'right': '0%'});
                    loadCat();
                }
            });
            /*http://appzventure.com/ios-7-concept-designs-future-iphone/*/

        </script>
    </head>
    <body style="background: url(img/bg.png); text-align: center;">
        <div id="contenedor">
            <div class="seccion" id="ciudades">
                <table style="width: 100%; height: 100%;"><tr><td>
                            <img style=" margin-top: 70px; max-width: 100%; width: 200px;" src="img/logo_directel.png">
                        </td></tr>
                    <tr><td><div id="ciudadCanvas"></div></td></tr>

                    <tr><td></td></tr>
                </table>
            </div>
            <div id="topbar">
                <img onclick="changeCity()" style="position: absolute; left: 10px; top: 10px; height: 30px;" src="img/ciudad.png">
                <img alt="Directel" style=" height: 40px; margin: 5px;" src="img/logo_directel.png">
                <div style="position: absolute; bottom: 3px; right: 10px; font-size: 11px" id="city"></div>
            </div>
            <div class="seccion" id="categorias">
                <table style="width: 100%; height: 100%;">
                    <tr><td>
                            <div id="categoriasCanvas"></div>
                        </td></tr>
                </table>
            </div>
        </div>

    </body>
</html>